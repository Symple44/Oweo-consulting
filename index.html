<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oweo - Expert ERP Charpente M√©tallique</title>
    
    <!-- ========================================
         SYST√àME DE TH√àME G√âN√âRIQUE
    ======================================== -->
    
    <!-- Variables et composants g√©n√©riques -->
    <link rel="stylesheet" href="css/theme-variables.css">
    <link rel="stylesheet" href="css/theme-components.css">
    
    <!-- Composants sp√©cifiques mais g√©n√©riques -->
    <link rel="stylesheet" href="css/navbar-generic.css">
    <link rel="stylesheet" href="css/footer-generic.css">
    
    <!-- Utilitaires et layout (si encore n√©cessaires) -->
    <link rel="stylesheet" href="css/utilities.css">
    <link rel="stylesheet" href="css/layout.css">
    
    <!-- Composants existants √† migrer progressivement -->
    <link rel="stylesheet" href="css/modal.css">
    <link rel="stylesheet" href="css/notifications.css">
    <link rel="stylesheet" href="css/demo-search.css">
    
    <!-- D√©mos (√† migrer vers le syst√®me g√©n√©rique) -->
    <link rel="stylesheet" href="css/demo-components.css">
    <link rel="stylesheet" href="css/auth-modal.css">
    <link rel="stylesheet" href="css/dstv-demo.css">
    
    <!-- Pages d'erreur -->
    <link rel="stylesheet" href="css/error-pages.css">
    
    <!-- Ic√¥nes -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Widget Calendly -->
    <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav id="navbar" class="navbar"></nav>
    
    <!-- Demo Search Banner (visible seulement en mode d√©mo) -->
    <div id="demo-search-banner" class="demo-search-banner" style="display: none;">
        <div class="demo-search-container">
            <div class="demo-search-content">
                <div class="demo-search-brand">
                    <i class="fas fa-search"></i>
                    <span>Navigation D√©mos</span>
                </div>
                <div class="demo-search-input-container">
                    <input 
                        type="text" 
                        id="demo-search-input" 
                        class="demo-search-input" 
                        placeholder="Rechercher une d√©mo ou fonctionnalit√©... (ex: 'chiffrage', 'DSTV', 'm√©trage')"
                        autocomplete="off"
                    >
                    <div id="demo-search-results" class="demo-search-results"></div>
                </div>
                <div class="demo-search-actions">
                    <button id="demo-search-help" class="demo-search-help-btn" title="Aide">
                        <i class="fas fa-question-circle"></i>
                    </button>
                    <button id="demo-search-close" class="demo-search-close-btn" title="Fermer">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main App Container -->
    <main id="app" class="app-container">
        <div class="loading-container">
            <div class="loading-spinner"></div>
            <p>Chargement de l'application...</p>
        </div>
    </main>
    
    <!-- Footer -->
    <footer id="footer" class="footer"></footer>
    
    <!-- Modals Container -->
    <div id="modals-container"></div>
    
    <!-- ========================================
         SCRIPTS - SYST√àME DE TH√àME
    ======================================== -->
    
    <!-- 1. Syst√®me de th√®me et utilitaires -->
    <script src="js/utils/theme-manager.js"></script>
    <script src="js/utils/component-builder.js"></script>
    
    <!-- 2. Configuration de migration (optionnel) -->
    <script src="js/config/theme-config.js"></script>
    
    <!-- ========================================
         SCRIPTS - ARCHITECTURE EXISTANTE
    ======================================== -->
    
    <!-- 3. Core Classes de base -->
    <script src="js/core/event-bus.js"></script>
    <script src="js/core/component-manager.js"></script>
    
    <!-- 4. Base Components -->
    <script src="js/components/base-component.js"></script>
    <script src="js/pages/base-page.js"></script>
    <script src="js/demos/base-demo.js"></script>
    
    <!-- 5. Core System -->
    <script src="js/core/router.js"></script>
    <script src="js/core/app.js"></script>
    
    <!-- 6. Components (version g√©n√©rique) -->
    <script src="js/components/navbar-generic.js"></script>
    <script src="js/components/footer-generic.js"></script>
    <script src="js/components/demo-search.js"></script>
    <script src="js/components/modal.js"></script>
    
    <!-- 7. Pages (version g√©n√©rique pour home) -->
    <script src="js/pages/home-page-generic.js"></script>
    <script src="js/pages/services.js"></script>
    <script src="js/pages/demos.js"></script>
    <script src="js/pages/contact.js"></script>
    <script src="js/pages/cgv.js"></script>
    
    <!-- 8. Demo Pages -->
    <script src="js/demos/chiffrage-demo.js"></script>
    <script src="js/demos/dstv-demo.js"></script>
    
    <!-- 9. Configuration -->
    <script src="js/config/company-info.js"></script>
    <script src="js/config/environment.js"></script>
    <script src="js/config/demo-config.js"></script>
    <script src="js/config/app-config.js"></script>
    
    <!-- 10. Utilitaires -->
    <script src="js/utils/dom-utils.js"></script>
    <script src="js/utils/animation-utils.js"></script>
    <script src="js/utils/client-access.js"></script>
    <script src="js/utils/notifications.js"></script>
    
    <!-- 11. Tools (d√©veloppement uniquement) -->
    <script src="js/tools/consistency-checker.js"></script>
    <script src="js/tools/migration-helper.js"></script>
    
    <!-- 12. Biblioth√®ques externes -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
    
    <!-- ========================================
         INITIALISATION AVEC SYST√àME G√âN√âRIQUE
    ======================================== -->
    <script>
        // Configuration pour utiliser les composants g√©n√©riques
        window.addEventListener('DOMContentLoaded', () => {
            // Remplacer les composants par les versions g√©n√©riques
            if (window.NavbarGeneric) {
                window.OweoNavbar = window.NavbarGeneric;
            }
            
            if (window.FooterGeneric) {
                window.OweoFooter = window.FooterGeneric;
            }
            
            if (window.HomePageGeneric) {
                window.HomePage = window.HomePageGeneric;
            }
            
            // Message console pour le syst√®me de th√®me
            console.log(`
üé® Syst√®me de Th√®me G√©n√©rique Actif
===================================
Utilisez ThemeManager pour changer de th√®me :
- ThemeManager.applyTheme('cool')
- ThemeManager.applyTheme('nature')
- ThemeManager.toggleMode()
- Ctrl+Shift+T pour ouvrir le s√©lecteur

Migration progressive :
- ThemeConfig.migration.migrateDOM()
            `);
        });
        
        // Initialisation de l'application (code existant)
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Initialisation de l\'application Oweo...');
            
            try {
                // Cr√©er l'instance de l'application
                window.app = new OweoApp();
                
                // Initialiser l'application
                await window.app.init();
                
                // D√©marrer l'application
                await window.app.start();
                
                console.log('‚úÖ Application initialis√©e avec succ√®s');
                
                // En mode d√©veloppement, afficher les outils
                if (window.location.hostname === 'localhost' || window.location.search.includes('debug=true')) {
                    console.log('üõ†Ô∏è Mode d√©veloppement activ√©');
                    console.log('Outils disponibles :');
                    console.log('- OweoDebug.validateSite()');
                    console.log('- OweoDebug.testDemoSearch()');
                    console.log('- ThemeManager (gestion des th√®mes)');
                    console.log('- ThemeConfig (configuration du th√®me)');
                }
                
            } catch (error) {
                console.error('‚ùå Erreur lors de l\'initialisation:', error);
                
                // Afficher une page d'erreur
                const appContainer = document.getElementById('app');
                if (appContainer) {
                    appContainer.innerHTML = `
                        <div class="error-page">
                            <div class="container">
                                <h1 class="error-code">500</h1>
                                <h2 class="error-title">Erreur de chargement</h2>
                                <p class="error-message">
                                    Une erreur s'est produite lors du chargement de l'application.
                                    Veuillez rafra√Æchir la page ou contacter le support.
                                </p>
                                <button class="btn btn--primary" onclick="location.reload()">
                                    <i class="fas fa-redo"></i>
                                    Rafra√Æchir
                                </button>
                            </div>
                        </div>
                    `;
                }
            }
        });
        
        // Gestion des erreurs JavaScript globales
        window.addEventListener('error', (event) => {
            // Ne pas traiter les erreurs Calendly
            if (event.filename && event.filename.includes('calendly')) {
                console.warn('Calendly script error (non-critical):', event.message);
                event.preventDefault();
                return;
            }
            
            console.error('Erreur JavaScript:', event.error);
        });
        
        // Gestion des promesses rejet√©es
        window.addEventListener('unhandledrejection', (event) => {
            console.error('Promise rejet√©e:', event.reason);
        });
        
        // Validation p√©riodique en d√©veloppement
        if (window.location.hostname === 'localhost') {
            setTimeout(() => {
                if (window.ConsistencyChecker) {
                    console.log('üîç Lancement de la v√©rification de coh√©rence...');
                    window.checkConsistency = () => new window.ConsistencyChecker().checkAll();
                    window.startMonitoring = () => new window.ConsistencyChecker().startMonitoring();
                    
                    // V√©rification initiale
                    window.checkConsistency();
                    
                    console.log('üí° Commandes disponibles :');
                    console.log('  - checkConsistency() : V√©rifier la coh√©rence');
                    console.log('  - startMonitoring() : Surveillance continue');
                    console.log('  - ThemeManager : Gestion des th√®mes');
                }
            }, 3000);
        }
    </script>
</body>
</html>